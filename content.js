const styleSheet=document.createElement("style");styleSheet.textContent=`
    .apply-btn-container {
        padding: 0 !important;
        margin: 10px 0 0 0 !important;
    }

    .resize-btn {
        all: unset !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 8px !important;
        padding: 0 16px !important;
        height: 44px !important;
        width: 100% !important;
        border-radius: 4px !important;
        cursor: pointer !important;
        background-color: #470CED !important;
        color: #FFFFFF !important;
        font-size: 14px !important;
        border: none !important;
        box-shadow: none !important;
        box-sizing: border-box !important;
    }
    
    .resize-btn:hover:not(:disabled) {
        background-color: #2A00A0 !important;
    }
    
    .resize-btn:disabled {
        background-color: #cfd4d4 !important;
        color: rgba(0, 0, 0, 0.5) !important;
        cursor: not-allowed !important;
    }

    .resize-btn img {
        width: 20px !important;
        height: 20px !important;
        margin-right: 10px !important;
        opacity: 1 !important;
        transition: none !important;
        filter: brightness(0) invert(1) !important;
        -webkit-transition: none !important;
        -moz-transition: none !important;
        -o-transition: none !important;
    }

    .resize-btn:disabled img {
        opacity: 0.5 !important;
        transition: none !important;
        filter: brightness(0) !important;
        -webkit-transition: none !important;
        -moz-transition: none !important;
        -o-transition: none !important;
    }

    .tab-container {
        margin-bottom: 20px !important;
        display: flex !important;
        width: 100% !important;
    }

    .tab-button {
        flex: 1 !important;
        padding: 8px 16px !important;
        border: 1px solid #470CED !important;
        background-color: #ffffff !important;
        color: #470CED !important;
        cursor: pointer !important;
        outline: none !important;
        margin: 0 !important;
        border-radius: 0 !important;
        text-align: center !important;
        border-right: none !important;
        font-size: 13px !important;
        transition: background-color 0.3s ease, color 0.3s ease !important;
    }

    .tab-button:last-child {
        border-right: 1px solid #470CED !important;
    }

    .tab-button.active {
        background-color: #470CED !important;
        color: #ffffff !important;
    }
`,document.head.appendChild(styleSheet),function(){"use strict";{let m={};const d={},c=[{name:"TUMBLER",displayName:"Tumbler",containerHeading:"Customize and Re-upload",ctaButtonText:"Apply and Upload",cardId:"TUMBLER-card",editButtonClass:"TUMBLER-edit-btn",resizeContainerClass:"tumbler-resize-container",uploadInputSelector:'label.file-upload-input[for="TUMBLER-DESIGN-wizzy"]',tabs:["One Side","Two Sides","2 Different Sides"],functions:{"One Side":["Custom Scale","100%","85%","75%"],"Two Sides":["Custom Scale","100%","85%","75%","Pattern"],"2 Different Sides":["Custom Scale","100%","85%","75%"]},finalCanvasDimensions:{width:3e3,height:1400},injectPosition:"second",functionsEnabled:{trimDesign:!0,resizeImage:!0,uploadFinalImage:!0},additionalUploadSteps:!1,disableScaleOptions:!1,patternSettings:{numberOfRows:3,designsPerRow:7},designDimensionsAndPositioning:{firstRow:{verticalAlignment:"center",snap:"top"},lastRow:{verticalAlignment:"center",snap:"bottom"},middleRows:{distribution:"evenly"}},patternStyle:{offset:!0},downloadacopy:!0},{name:"TOTE_BAG",displayName:"Tote Bag",containerHeading:"Customize and Re-upload:",ctaButtonText:"Apply and Upload",cardId:"TOTE_BAG-card",editButtonClass:"TOTE_BAG-edit-btn",resizeContainerClass:"tote-resize-container",uploadInputSelector:'label.file-upload-input[for="TOTE_BAG-DESIGN-wizzy"]',tabs:["Standard"],functions:{Standard:["Custom Scale","100%","85%","75%","Pattern"]},finalCanvasDimensions:{width:2925,height:2925},injectPosition:"first",functionsEnabled:{trimDesign:!0,resizeImage:!0,uploadFinalImage:!0},additionalUploadSteps:!1,disableScaleOptions:!1,patternSettings:{numberOfRows:4,designsPerRow:4},designDimensionsAndPositioning:{firstRow:{verticalAlignment:"center",snap:"top"},lastRow:{verticalAlignment:"center",snap:"bottom"},middleRows:{distribution:"evenly"}},patternStyle:{offset:!0},downloadacopy:!0,fillArtwork:!0},{name:"THROW_PILLOW",displayName:"Throw Pillow",containerHeading:"Customize and Re-upload:",ctaButtonText:"Apply and Upload",cardId:"THROW_PILLOW-card",editButtonClass:"THROW_PILLOW-edit-btn",resizeContainerClass:"throw-resize-container",uploadInputSelector:'label.file-upload-input[for="THROW_PILLOW-DESIGN-wizzy"]',tabs:["Standard"],functions:{Standard:["Custom Scale","100%","85%","75%","Pattern"]},finalCanvasDimensions:{width:2925,height:2925},injectPosition:"second",functionsEnabled:{trimDesign:!0,resizeImage:!0,uploadFinalImage:!0},additionalUploadSteps:!1,disableScaleOptions:!1,patternSettings:{numberOfRows:4,designsPerRow:4},designDimensionsAndPositioning:{firstRow:{verticalAlignment:"center",snap:"top"},lastRow:{verticalAlignment:"center",snap:"bottom"},middleRows:{distribution:"evenly"}},patternStyle:{offset:!0},downloadacopy:!0,fillArtwork:!0},{name:"PHONE_CASE_APPLE_IPHONE",displayName:"iPhone Case",containerHeading:"Customize and Re-upload:",ctaButtonText:"Apply and Upload",cardId:"PHONE_CASE_APPLE_IPHONE-card",editButtonClass:"PHONE_CASE_APPLE_IPHONE-edit-btn",resizeContainerClass:"iphone-resize-container",uploadInputSelector:'label.file-upload-input[for="PHONE_CASE_APPLE_IPHONE-DESIGN-wizzy"]',tabs:["Standard"],functions:{Standard:["Custom Scale","100%","85%","75%","Pattern"]},finalCanvasDimensions:{width:1800,height:3200},injectPosition:"second",functionsEnabled:{trimDesign:!0,resizeImage:!0,uploadFinalImage:!0},additionalUploadSteps:!1,disableScaleOptions:!1,patternSettings:{numberOfRows:8,designsPerRow:4},designDimensionsAndPositioning:{firstRow:{verticalAlignment:"center",snap:"top"},lastRow:{verticalAlignment:"center",snap:"bottom"},middleRows:{distribution:"evenly"}},patternStyle:{offset:!0},downloadacopy:!0,fillArtwork:!0},{name:"POP_SOCKET",displayName:"PopSockets Grip",containerHeading:"Customize and Re-upload:",ctaButtonText:"Apply and Upload",cardId:"POP_SOCKET-card",editButtonClass:"POP_SOCKET-edit-btn",resizeContainerClass:"popsockets-resize-container",uploadInputSelector:'label.file-upload-input[for="POP_SOCKET-DESIGN-wizzy"]',tabs:["Standard"],functions:{Standard:["Custom Scale","100%","85%","75%","Pattern"]},finalCanvasDimensions:{width:1200,height:1200},injectPosition:"second",functionsEnabled:{trimDesign:!0,resizeImage:!0,uploadFinalImage:!0},additionalUploadSteps:!1,disableScaleOptions:!1,patternSettings:{numberOfRows:3,designsPerRow:3},designDimensionsAndPositioning:{firstRow:{verticalAlignment:"center",snap:"top"},lastRow:{verticalAlignment:"center",snap:"bottom"},middleRows:{distribution:"evenly"}},patternStyle:{offset:!0},downloadacopy:!0,fillArtwork:!0}];function u(){const e=JSON.parse(JSON.stringify(m));for(const m in e){var t=e[m];if(t.tabs)for(const m in t.tabs){const e=t.tabs[m];e.leftImageData&&delete e.leftImageData,e.rightImageData&&delete e.rightImageData}}localStorage.setItem("accessoriesResizePreferences",JSON.stringify(e))}function r(t,n){const a=n.closest(".mb-base");if("ZIP_HOODIE"===t.name)[".tote-resize-container",".throw-resize-container",".iphone-resize-container",".popsockets-resize-container"].forEach(e=>{e=a.querySelector(e);e&&e.remove()});else if(!d[t.name]){if(!n.querySelector("."+t.resizeContainerClass)){i=t,o=n,c.forEach(e=>{if(e.name!==i.name){const i=o.querySelector("."+e.resizeContainerClass);i&&i.remove()}});var i,o,r=function(a){const i=document.createElement("div"),o=(i.className=a.resizeContainerClass,i.style.backgroundColor="#ffffff",i.style.border="0.0625rem solid #d5dbdb",i.style.marginTop="10px",i.style.borderRadius="0px",i.style.boxSizing="border-box",i.style.fontFamily='"Amazon Ember", sans-serif',i.style.padding="15px",document.createElement("div"));if(o.textContent=a.containerHeading,o.style.fontSize="13px",o.style.fontWeight="600",o.style.color="#333333",o.style.backgroundColor="#fafafa",o.style.borderBottom="0.0625rem solid #efefef",o.style.padding="7.5px 15px",o.style.margin="-15px -15px 15px -15px",o.style.width="auto",i.appendChild(o),1<a.tabs.length){const o=document.createElement("div");o.className="tab-container",a.tabs.forEach(n=>{var e=document.createElement("button");e.textContent=n,e.className="tab-button",m[a.name].selectedTab===n&&e.classList.add("active"),e.dataset.tabName=n,e.addEventListener("click",async function(){var e,t=m[a.name];t.selectedTab!==n&&(t.selectedTab=n,u(),o.querySelectorAll(".tab-button").forEach(e=>{e.dataset.tabName===n?e.classList.add("active"):e.classList.remove("active")}),e=i.querySelector(".scale-options-container"),a.disableScaleOptions||(f(a,e,i),e.style.display="block"),g(a,i),await S(300),p(a,i),"2 Different Sides"===n?x(i,a):D(i),t.tabs[n]||(t.tabs[n]={scalingOption:"percent85",customScaleValue:""},u()),f(a,e,i))}),o.appendChild(e)}),i.appendChild(o)}else m[a.name].selectedTab=a.tabs[0],u();var e=document.createElement("div"),t=(e.className="scale-options-container",e.style.marginTop="20px",e.style.marginBottom="0px",document.createElement("form")),n=(t.className="resize-form",document.createElement("div"));if(n.style.marginBottom="20px",n.className="radio-container",t.appendChild(n),e.appendChild(t),i.appendChild(e),a.downloadacopy){const o=document.createElement("div"),d=(o.style.marginTop="16px",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="flex-start",o.style.cursor="pointer",o.style.width="100%",document.createElement("div")),c=(d.style.width="36px",d.style.height="18px",d.style.borderRadius="18px",d.style.backgroundColor=m[a.name].downloadaCopy?"#470CED":"rgb(207, 212, 212)",d.style.position="relative",d.style.transition="background-color 0.3s",d.style.marginRight="10px",document.createElement("span")),f=(c.style.width="12px",c.style.height="12px",c.style.borderRadius="50%",c.style.backgroundColor="white",c.style.position="absolute",c.style.top="3px",c.style.left="3px",c.style.transition="transform 0.3s",c.style.transform=m[a.name].downloadaCopy?"translateX(18px)":"translateX(0)",d.appendChild(c),document.createElement("span"));f.textContent="Download a copy",f.style.fontSize="14px",f.style.color="rgb(100, 100, 100)",f.style.userSelect="none",o.addEventListener("click",function(){var e=!m[a.name].downloadaCopy;m[a.name].downloadaCopy=e,d.style.backgroundColor=e?"#470CED":"rgb(207, 212, 212)",c.style.transform=e?"translateX(18px)":"translateX(0)",u()}),o.appendChild(d),o.appendChild(f),i.appendChild(o)}n=document.createElement("div");n.className="apply-btn-container",n.style.textAlign="left",n.style.marginTop="10px",n.style.marginBottom="0px";const r=document.createElement("button");r.type="button",r.className="resize-btn",r.disabled=!1,r.title="Click to apply the resizing and upload the design.";var t=document.createElement("img"),s=(t.src=chrome.runtime.getURL("assets/apply.svg"),t.alt="Apply and Upload Icon",t.style.width="20px",t.style.height="20px",t.style.marginRight="10px",document.createElement("span"));function l(e){e.disabled=!!e.disabled}return s.textContent=a.ctaButtonText,r.appendChild(t),r.appendChild(s),l(r),r.addEventListener("click",async()=>{const e=r,t=r.closest("."+a.resizeContainerClass);e.disabled=!0,e.style.cursor="not-allowed",l(e);var n=function(e,t){var n=t.querySelector('input[name="resizeOption"]:checked'),e=m[e.name],a=e.selectedTab;if(e.tabs[a],n)switch(n.id){case"custom":const m=t.querySelector('input[type="number"]'),e=parseFloat(m.value);return 50<=e&&e<=100?e/100:null;case"percent100":default:return 1;case"percent85":return.85;case"percent75":return.75;case"pattern":return"pattern"}return 1}(a,t);if(null!==n){var i,n=await async function(n,a){try{let t;if("pattern"===n&&a.patternSettings)t=await async function(t){try{var n=await h();if(!n)return null;var{trimDesign:a,resizeImage:i}=t.functionsEnabled;let e=n;var o=await v(e=(a||i)&&(a&&(e=await b(n)),i&&(e=await w(e,t,1)),a||i)?await C(e,t):e,300);return await E(o,t),o}catch(t){return null}}(a);else if("TUMBLER"===a.name&&"2 Different Sides"===m[a.name].selectedTab)t=await async function(e,t){try{var n,a,i,o,r,s=m[e.name].tabs["2 Different Sides"],l=s.leftImageData,d=s.rightImageData;return l&&d?(n=await I(l,e,t),a=await I(d,e,t),(i=document.createElement("canvas")).width=e.finalCanvasDimensions.width,i.height=e.finalCanvasDimensions.height,(o=i.getContext("2d")).clearRect(0,0,i.width,i.height),0,y(o,n,31,r=(e.finalCanvasDimensions.height-1400)/2,1400,1400),y(o,a,1566.6667,r,1400,1400),await v(i,300)):null}catch(e){return null}}(a,n);else{var i=await h();if(!i)return null;var{trimDesign:o,resizeImage:r}=a.functionsEnabled;let e=i;(o||r)&&(o&&(e=await b(i)),r&&(e=await w(e,a,n)),o||r)&&(e=(d=e,c=a,await("pattern"===n&&c.patternSettings?C(d,c):new Promise(e=>{var t=document.createElement("canvas"),n=(t.width=c.finalCanvasDimensions.width,t.height=c.finalCanvasDimensions.height,t.getContext("2d"));if(n.clearRect(0,0,t.width,t.height),"TUMBLER"===c.name){var a=n,i=d,o=c,r=1400,s=m[o.name].selectedTab;if("Two Sides"===s){const m=(o.finalCanvasDimensions.height-r)/2;y(a,i,31,m,1400,r),y(a,i,1566.6667,m,1400,r)}else"One Side"===s&&y(a,i,31,(o.finalCanvasDimensions.height-r)/2,1400,r)}else{var l=n;s=d,a=c.finalCanvasDimensions.width,i=c.finalCanvasDimensions.height;let e,t;if(s instanceof HTMLCanvasElement)e=s.width,t=s.height;else{const l=new Image;l.src=s,e=l.width,t=l.height}a=(a-e)/2,i=(i-t)/2,l.drawImage(s,a,i,e,t)}e(t)})))),t=await v(e,300)}return await E(t,a),t}catch(e){return null}var d,c}(n,a);if(m[a.name].downloadaCopy&&n){const m=URL.createObjectURL(n),e=document.createElement("a");e.href=m,e.download=a.name+"_design_copy.png",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(m)}if(a.fillArtwork)try{i=".product-editor #fill-artwork-btn",await new Promise((n,e)=>{var t=document.querySelector(i);if(t)n(t);else{const a=new MutationObserver(e=>{var t=document.querySelector(i);t&&(n(t),a.disconnect())});a.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect(),e(new Error(`Element with selector "${i}" not found within 60000ms.`))},6e4)}});const m=document.querySelector(".product-editor #fill-artwork-btn");m&&m.click()}catch(e){}}await S(300),e.disabled=!1,e.style.cursor="pointer",l(e)}),n.appendChild(r),i.appendChild(n),a.disableScaleOptions||f(a,e,i),g(a,i),"2 Different Sides"===m[a.name].selectedTab&&x(i,a),i}(t);r.setAttribute("data-resize-container",t.name);let e=null;switch(t.injectPosition){case"first":e=n.firstChild,n.insertBefore(r,e);break;case"second":(e=n.children[1])?n.insertBefore(r,e):n.appendChild(r);break;case"third":(e=n.children[2])?n.insertBefore(r,e):n.appendChild(r);break;default:n.appendChild(r)}var s=r.querySelector(".scale-options-container");t.disableScaleOptions?s.style.display="none":f(t,s,r),g(t,r),p(t,r)}d[t.name]=!1}}function p(e,t){if(t.querySelector(".resize-btn")){g(e,t);const n=m[e.name].selectedTab;if("TUMBLER"===e.name&&"2 Different Sides"===n){const m=t.querySelector(".upload-areas-container");if(m){const n={attributes:!0,childList:!0,subtree:!0};new MutationObserver(()=>{g(e,t)}).observe(m,n)}}else{const m=t.closest(".product-editor");if(m){const n={childList:!0,subtree:!0};new MutationObserver(()=>{g(e,t)}).observe(m,n)}}}}function f(r,s,l){const d=s.querySelector(".radio-container");for(;d.firstChild;)d.removeChild(d.firstChild);const e=m[r.name],t=e.selectedTab,c=e.tabs[t];let p=null;var n,a;if(n=r,a=m[n.name].selectedTab,n.functions[a].map(e=>{switch(e){case"Custom Scale":return{id:"custom",label:""};case"100%":return{id:"percent100",label:"100%"};case"85%":return{id:"percent85",label:"85%"};case"75%":return{id:"percent75",label:"75%"};case"Pattern":return{id:"pattern",label:"Pattern"};default:return null}}).filter(e=>null!==e).forEach(e=>{var t,n=document.createElement("label");n.className="radio-label",n.style.marginRight="15px",n.style.fontSize="13px",n.style.display="inline-flex",n.style.alignItems="center",n.style.lineHeight="1.5rem",n.style.position="relative",n.style.cursor="pointer";const a=document.createElement("input"),i=(a.type="radio",a.name="resizeOption",a.id=e.id,a.value=e.label,a.style.opacity="0",a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.width="100%",a.style.height="100%",a.style.cursor="pointer",document.createElement("span")),o=(i.className="checkmark",i.style.display="inline-block",i.style.width="1rem",i.style.height="1rem",i.style.border="0.0625rem solid #470CED",i.style.borderRadius="50%",i.style.backgroundColor="#ffffff",i.style.marginRight="5px",i.style.position="relative",document.createElement("span"));o.style.height="0.5rem",o.style.width="0.5rem",o.style.backgroundColor="#ffffff",o.style.borderRadius="50%",o.style.position="absolute",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",i.appendChild(o),a.addEventListener("change",async function(){s.querySelectorAll(".radio-label input").forEach(e=>{e=e.parentElement.querySelector(".checkmark");e.style.backgroundColor="#ffffff",e.querySelector("span").style.backgroundColor="#ffffff"}),a.checked&&(i.style.backgroundColor="#470CED",o.style.backgroundColor="#ffffff",c.scalingOption=e.id,u()),a.checked&&"custom"===e.id?p&&(p.disabled=!1,p.focus()):p&&(p.disabled=!0,p.value="",p.style.borderBottom="2px solid #ccc",c.customScaleValue=""),g(r,l),await S(300)}),c.scalingOption===e.id&&(a.checked=!0,i.style.backgroundColor="#470CED",o.style.backgroundColor="#ffffff"),n.appendChild(a),n.appendChild(i),"custom"===e.id?((p=document.createElement("input")).type="number",p.min="50",p.max="100",p.step="0.1",p.style.width="64px",p.style.height="calc(1.5rem * 1.1)",p.style.marginLeft="5px",p.style.fontSize="13px",p.style.padding="2px",p.style.border="none",p.style.borderBottom="2px solid #ccc",p.style.borderRadius="0",p.disabled="custom"!==c.scalingOption,p.style.transition="border-bottom 0.3s ease",p.value=c.customScaleValue||"",p.addEventListener("input",async function(){var e=parseFloat(p.value);e<50||100<e||isNaN(e)?p.style.borderBottom="2px solid red":(p.style.borderBottom="2px solid #ccc",c.customScaleValue=p.value,u()),g(r,l),await S(300)}),p.addEventListener("blur",async function(){var e=parseFloat(p.value);isNaN(e)||e<50||100<e?p.style.borderBottom="2px solid red":p.style.borderBottom="2px solid #ccc",await S(300)}),n.appendChild(p),(t=document.createElement("span")).textContent=" %",t.style.marginLeft="8px",n.appendChild(t)):n.appendChild(document.createTextNode(e.label)),n.style.paddingLeft="0",d.appendChild(n)}),p){const s=m[r.name].selectedTab,u=m[r.name].tabs[s];p.value=u.customScaleValue||""}g(r,l)}function g(t,n){if(n){var a=n.querySelector(".resize-btn");if(a){let e=!0;var i=m[t.name],o=i.selectedTab,i=i.tabs[o],r=n.querySelector('input[name="resizeOption"]:checked');if(r&&"custom"===r.id){const m=n.querySelector('input[type="number"]'),t=parseFloat(m.value);(isNaN(t)||t<50||100<t)&&(e=!1)}if(!r||"pattern"!==r.id||t.functions[o].includes("Pattern")&&t.patternSettings&&t.designDimensionsAndPositioning&&t.patternStyle||(e=!1),"TUMBLER"===t.name&&"2 Different Sides"===o){const m=i.leftImageUploaded,t=i.rightImageUploaded;m&&t||(e=!1)}else{const m=n.closest(".product-editor");e=!!m&&!!m.querySelector(".delete-button")}if(a.disabled=!e,a.style.cursor=e?"pointer":"not-allowed",a.disabled){a.style.backgroundImage="none",a.style.backgroundColor="#cfd4d4",a.style.color="#000000";const m=a.querySelector("img");m&&(m.style.filter="brightness(0)")}else{a.style.backgroundColor="#470CED",a.style.color="#ffffff";const m=a.querySelector("img");m&&(m.style.filter="brightness(100)")}}}}function y(e,t,n,a,i,o){var r=t.width,s=t.height,l=Math.min(i/r,o/s,1),r=r*l,s=s*l;e.drawImage(t,n+(i-r)/2,a+(o-s)/2,r,s)}async function h(){return new Promise((t,n)=>{var a=document.querySelectorAll('img[alt$=".png"], img[alt="null"]');if(0===a.length)n("Image element not found.");else{let e=Array.from(a).find(e=>e.getAttribute("alt").endsWith(".png"));if(e=e||Array.from(a).find(e=>"null"===e.getAttribute("alt"))){a=e.getAttribute("src");if(a){const i=new Image;i.crossOrigin="Anonymous",i.src=a,i.onload=()=>{try{const n=document.createElement("canvas");n.width=i.width,n.height=i.height,n.getContext("2d",{willReadFrequently:!0}).drawImage(i,0,0);var e=n.toDataURL();t(e)}catch(e){n(e)}},i.onerror=e=>{n(e)}}else n("Image src attribute is missing.")}else n("Image element not found.")}})}async function b(e){return new Promise((r,t)=>{const s=new Image;s.src=e,s.onload=()=>{var e=document.createElement("canvas"),e=(e.width=s.width,e.height=s.height,e.getContext("2d",{willReadFrequently:!0})),t=(e.drawImage(s,0,0),e.getImageData(0,0,s.width,s.height)),{topTrim:t,bottomTrim:n,leftTrim:a,rightTrim:i}=function(n){var a=n.data;let i=0,o=n.height,r=0,s=n.width;for(let t=0;t<n.height;t++){for(let e=0;e<n.width;e++)if(0!==a[4*(t*n.width+e)+3]){i=t;break}if(0!==i)break}for(let t=n.height-1;t>=i;t--){for(let e=0;e<n.width;e++)if(0!==a[4*(t*n.width+e)+3]){o=t;break}if(o!==n.height)break}for(let t=0;t<n.width;t++){for(let e=i;e<=o;e++)if(0!==a[4*(e*n.width+t)+3]){r=t;break}if(0!==r)break}for(let t=n.width-1;t>=r;t--){for(let e=i;e<=o;e++)if(0!==a[4*(e*n.width+t)+3]){s=t;break}if(s!==n.width)break}return i>=o||r>=s?{topTrim:0,bottomTrim:n.height,leftTrim:0,rightTrim:n.width}:{topTrim:i,bottomTrim:o,leftTrim:r,rightTrim:s}}(t),i=i-a+1,n=n-t+1,o=document.createElement("canvas");o.width=i,o.height=n,o.getContext("2d",{willReadFrequently:!0}).putImageData(e.getImageData(a,t,i,n),0,0),r(o)},s.onerror=e=>t(e)})}async function w(e,c,p){return new Promise(l=>{const d=new Image;d.src=e.toDataURL(),d.onload=()=>{var e=document.createElement("canvas"),t=d.width/d.height;let n=c.finalCanvasDimensions.width,a=c.finalCanvasDimensions.height;n/t>a?n=a*t:a=n/t,e.width=n,e.height=a;var t=e.getContext("2d"),i=n*p,o=a*p,r=(n-i)/2,s=(a-o)/2;t.clearRect(0,0,n,a),t.drawImage(d,r,s,i,o),l(e)}})}function C(u,r){return new Promise(e=>{var t=document.createElement("canvas");t.width=r.finalCanvasDimensions.width,t.height=r.finalCanvasDimensions.height;const s=t.getContext("2d"),{numberOfRows:n,designsPerRow:l}=(s.clearRect(0,0,t.width,t.height),r.patternSettings),d=u.width,c=u.height,p=(r.finalCanvasDimensions.width-10*(l+1))/l,m=c*(p/d),a=t.height-20-m*n,i=1<n?a/(n-1):0,o=Array.from({length:n},(e,t)=>10+t*(m+i));o.forEach((n,a)=>{var e=(a+1)%2==0?l+1:l;for(let t=0;t<e;t++){let e=10+t*(10+p);(a+1)%2==0&&(e-=p/2);const l=.75*p,i=.75*m,o=e+(p-l)/2,r=n+(m-i)/2;s.drawImage(u,0,0,d,c,o,r,l,i)}}),e(t)})}async function v(n,r){return new Promise(o=>{let e;if("string"==typeof n)e=n;else{if(!(n instanceof HTMLCanvasElement))return void o(null);e=n.toDataURL()}const t=new Image;t.src=e,t.onload=()=>{var e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e.toBlob(async function(t){var e=await t.arrayBuffer(),n=new Uint8Array(e),a=[137,80,78,71,13,10,26,10];for(let e=0;e<a.length;e++)if(n[e]!==a[e])return void o(t);var e=Math.round(39.3701*r),e=new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e,e>>>24&255,e>>>16&255,e>>>8&255,255&e,1]),e=new Uint8Array([112,72,89,115,...e]),i=function(t){let n=-1;for(let e=0;e<t.length;e++)n=n>>>8^T[255&(n^t[e])];return(-1^n)>>>0}(e),e=new Uint8Array([0,0,0,9,...e,i>>>24&255,i>>>16&255,i>>>8&255,255&i]),i=new Uint8Array(n.length+e.length),e=(i.set(n.slice(0,33),0),i.set(e,33),i.set(n.slice(33),33+e.length),new Blob([i],{type:"image/png"}));o(e)},"image/png")},t.onerror=e=>o(null)})}{const t=localStorage.getItem("accessoriesResizePreferences");if(t){m=JSON.parse(t);for(const t in m){const c=m[t];if(c.tabs)for(const e in c.tabs){const t=c.tabs[e];t.leftImageData&&(t.leftImageData=null),t.rightImageData&&(t.rightImageData=null),t.leftImageUploaded&&(t.leftImageUploaded=!1),t.rightImageUploaded&&(t.rightImageUploaded=!1)}}}else c.forEach(n=>{let e=n.tabs[0];"TUMBLER"===n.name&&(e="Two Sides"),m[n.name]={selectedTab:e,tabs:{},downloadaCopy:!1},n.tabs.forEach(e=>{let t="percent85";"POP_SOCKET"===n.name&&(t="percent100"),m[n.name].tabs[e]={scalingOption:t,customScaleValue:"",..."2 Different Sides"===e&&{leftImageUploaded:!1,rightImageUploaded:!1,leftImageData:null,rightImageData:null}}}),void 0!==n.fillArtwork&&(m[n.name].fillArtwork=n.fillArtwork)}),u()}document.addEventListener("click",function(e){if(e.target.matches(".btn.btn-secondary.btn-edit")||e.target.matches(".btn-secondary.btn-edit")){const n=e.target,a=Array.from(n.classList),i=a.find(e=>e.endsWith("-edit-btn"))?.replace("-edit-btn","").toUpperCase();if(a.includes("ZIP_HOODIE-edit-btn")){const o=n.closest("div.mb-base");void(o&&[".tote-resize-container",".throw-resize-container",".iphone-resize-container",".popsockets-resize-container"].forEach(e=>{e=o.querySelector(e);e&&e.remove()}))}else{var t;i&&(e=c.find(e=>e.name===i))&&(t=n.closest("div.mb-base"))&&(t=t.querySelector(".form-row > .col-6:nth-child(2)"))&&r(e,t)}}});const T=(()=>{let t;var n=[];for(let e=0;e<256;e++){t=e;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;n[e]=t}return n})();async function E(e,t,n=!1,a=1,i=2){var o=document.querySelector(`.${t.resizeContainerClass} .resize-btn`);if(!n){const e=document.querySelector(".delete-button");if(e&&(e.click(),await S(300),t.additionalUploadSteps)){const e=document.querySelector(".btn.btn-outline-primary.btn-BACK.ng-star-inserted");e?(await S(300),e.click(),await S(300)):o&&(o.title="Back button not found. Cannot proceed with uploading.")}}const r=document.querySelector(t.uploadInputSelector);if(r){const n=r.getAttribute("for"),l=document.getElementById(n);if(l){const n=new DataTransfer,r=new File([e],"final_design.png",{type:"image/png"});n.items.add(r),l.files=n.files;var s=new Event("change",{bubbles:!0}),s=(l.dispatchEvent(s),await S(300),await S(700),document.querySelector(".sci-icon.sci-error"));s&&null!==s.offsetParent&&(a<i?await E(e,t,!0,a+1,i):o&&(o.title="Re-upload failed after multiple attempts."))}else o&&(o.title="File input not found. Cannot proceed with uploading.")}else o&&(o.title="Upload label not found. Cannot proceed with uploading.")}function S(t){return new Promise(e=>setTimeout(e,t))}function x(e,t){D(e);var n=document.createElement("div"),a=(n.className="upload-areas-container",n.style.display="flex",n.style.justifyContent="space-between",n.style.gap="16px",n.style.marginTop="20px",s("left",t)),t=s("right",t),a=(n.appendChild(a),n.appendChild(t),e.querySelector(".scale-options-container"));e.insertBefore(n,a.nextSibling)}function D(e){e=e.querySelector(".upload-areas-container");e&&e.remove()}function s(t,n){const a=document.createElement("div"),i=(a.className=`upload-container ${t}-upload`,a.style.border="1.5px dashed #470CED",a.style.borderRadius="8px",a.style.width="calc(50% - 8px)",a.style.height="120px",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.boxSizing="border-box",a.style.position="relative",a.style.cursor="pointer",m[n.name].tabs["2 Different Sides"]);if(i[t+"ImageUploaded"]){a.classList.add("success"),a.style.borderColor="#01BB87",a.innerHTML="";const m=document.createElement("div");m.className="upload-content";var e=document.createElement("img"),e=(e.src=chrome.runtime.getURL("assets/loaded.svg"),e.alt="Loaded",e.style.width="40px",e.style.height="40px",m.appendChild(e),a.appendChild(m),document.createElement("button")),o=(e.className="delete-btn",e.style.backgroundColor="#fff5f5",e.style.border="none",e.style.borderRadius="50%",e.style.width="40px",e.style.height="40px",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.cursor="pointer",e.style.position="absolute",e.style.right="16px",e.style.bottom="16px",document.createElement("img"));o.src=chrome.runtime.getURL("assets/clear.svg"),o.alt="Clear",o.style.width="20px",o.style.height="20px",e.appendChild(o),e.addEventListener("click",e=>{e.stopPropagation(),i[t+"ImageData"]=null,i[t+"ImageUploaded"]=!1,u(),a.classList.remove("success"),a.style.borderColor="#470CED",a.innerHTML="",a.appendChild(s(t,n).firstChild),g(n,a.closest("."+n.resizeContainerClass))}),a.appendChild(e)}else{const m=document.createElement("div"),t=(m.className="upload-content",m.style.display="flex",m.style.flexDirection="column",m.style.alignItems="center",document.createElement("img")),n=(t.src=chrome.runtime.getURL("assets/draganddrop.svg"),t.alt="Drag and Drop",t.style.width="40px",t.style.height="40px",t.style.marginBottom="8px",document.createElement("p")),u=(n.textContent="Drag and drop",n.style.fontSize="14px",n.style.fontWeight="700",n.style.color="#470CED",n.style.margin="0",document.createElement("p"));u.textContent="PNG format",u.style.fontSize="14px",u.style.color="#9AA5B1",u.style.margin="0",m.appendChild(t),m.appendChild(n),m.appendChild(u),a.appendChild(m)}return a.addEventListener("dragover",e=>{e.preventDefault(),a.style.borderColor="#01BB87"}),a.addEventListener("dragleave",()=>{a.style.borderColor="#470CED"}),a.addEventListener("drop",e=>{e.preventDefault(),a.style.borderColor="#470CED",l(e.dataTransfer.files[0],a,t,n)}),a.addEventListener("click",e=>{if(!e.target.closest(".delete-btn")){const e=document.createElement("input");e.type="file",e.accept="image/png",e.onchange=()=>{l(e.files[0],a,t,n)},e.click()}}),a}function l(e,n,a,i){const o=m[i.name].tabs["2 Different Sides"];if(e&&"image/png"===e.type){const m=new FileReader;m.onload=()=>{var e=m.result,e=(o[a+"ImageData"]=e,o[a+"ImageUploaded"]=!0,u(),n.classList.add("success"),n.style.borderColor="#01BB87",n.innerHTML="",document.createElement("div")),t=(e.className="upload-content",document.createElement("img")),t=(t.src=chrome.runtime.getURL("assets/loaded.svg"),t.alt="Loaded",t.style.width="40px",t.style.height="40px",e.appendChild(t),n.appendChild(e),document.createElement("button")),e=(t.className="delete-btn",t.style.backgroundColor="#fff5f5",t.style.border="none",t.style.borderRadius="50%",t.style.width="40px",t.style.height="40px",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.cursor="pointer",t.style.position="absolute",t.style.right="16px",t.style.bottom="16px",document.createElement("img"));e.src=chrome.runtime.getURL("assets/clear.svg"),e.alt="Clear",e.style.width="20px",e.style.height="20px",t.appendChild(e),t.addEventListener("click",e=>{e.stopPropagation(),o[a+"ImageData"]=null,o[a+"ImageUploaded"]=!1,u(),n.classList.remove("success"),n.style.borderColor="#470CED",n.innerHTML="",n.appendChild(s(a,i).firstChild),g(i,n.closest("."+i.resizeContainerClass))}),n.appendChild(t),g(i,n.closest("."+i.resizeContainerClass))},m.readAsDataURL(e)}else{n.classList.add("error"),n.style.borderColor="#FF391F",n.innerHTML="";const m=document.createElement("div"),e=(m.className="upload-content",m.style.display="flex",m.style.alignItems="center",m.style.justifyContent="center",m.style.gap="16px",document.createElement("img")),u=(e.src=chrome.runtime.getURL("assets/error.svg"),e.alt="Error",e.style.width="40px",e.style.height="40px",document.createElement("div")),o=(u.className="upload-text",document.createElement("p"));o.textContent="Invalid File",o.style.fontSize="16px",o.style.color="#FF391F",o.style.fontWeight="bold",o.style.margin="0";var t=document.createElement("p");t.textContent="Upload a PNG file.",t.style.fontSize="14px",t.style.color="#9AA5B1",t.style.margin="0",u.appendChild(o),u.appendChild(t),m.appendChild(e),m.appendChild(u),n.appendChild(m),setTimeout(()=>{n.classList.remove("error"),n.style.borderColor="#470CED",n.innerHTML="",n.appendChild(s(a,i).firstChild)},2e3)}}async function I(e,t,n){var{trimDesign:a,resizeImage:i}=t.functionsEnabled;let o=e;return o=(a||i)&&(a&&(o=await b(e)),i)?await w(o,t,n):o}{const n=document.querySelector(".product-editor");var e;n&&(e=((t,n)=>{let a;return(...e)=>{clearTimeout(a),a=setTimeout(()=>{t(...e)},n)}})(function(){n.querySelectorAll("div.mb-base").forEach(n=>{c.forEach(e=>{var t;!n.querySelector("."+e.resizeContainerClass)&&m[e.name]&&(t=n.querySelector(".form-row > .col-6:nth-child(2)"))&&r(e,t)})})},300),new MutationObserver(e).observe(n,{childList:!0,subtree:!0}))}}}();